{% extends 'academics/base.html' %}
{% block body %}
<div class="container mt-5">
  <h2>{{ problem.title }}</h2>

  <!-- üîπ Difficulty Badge -->
  <p>
    <span class="badge 
      {% if problem.difficulty == 'E' %}bg-success
      {% elif problem.difficulty == 'M' %}bg-warning text-dark
      {% else %}bg-danger
      {% endif %}">
      {% if problem.difficulty == 'E' %}Easy
      {% elif problem.difficulty == 'M' %}Medium
      {% else %}Hard
      {% endif %}
    </span>

    <!-- ‚úÖ Solved Badge -->
    {% if user.is_authenticated and problem.id in solved_ids %}
      <span class="badge bg-info text-dark ms-2">Solved ‚úÖ</span>
    {% endif %}
  </p>

  <hr>

  <!-- üßæ Problem Description -->
  <div class="problem-description">
    {{ problem.question_text|safe }}
  </div>

  <hr>

  <!-- üîñ Tags -->
  <p><strong>Tags:</strong>
    {% for tag in problem.tags.all %}
      <span class="text-success">{{ tag.name }}</span>{% if not forloop.last %}, {% endif %}
    {% endfor %}
  </p>

  <!-- üöÄ Solve on Codeforces -->
  <div class="mt-4">
  {% if request.user.profile.codeforces_handle %}
    {% if user_handle_valid %}
      {% if has_solved %}
        <div class="alert alert-success">
          ‚úÖ Congratulations! You have already solved this problem on Codeforces.
          <div class="mt-4">
            <a href="https://codeforces.com/contest/{{ problem.contest_id }}/my" 
              target="_blank" class="btn btn-outline-primary">
              Show My Solution 
            </a>
  </div>
        </div>
      {% else %}
        <a href="https://codeforces.com/contest/{{ problem.contest_id }}/submit/{{ problem.index }}" 
           target="_blank" class="btn btn-outline-primary">
          üöÄ Solve on Codeforces (as {{ request.user.profile.codeforces_handle }})
        </a>
      {% endif %}
    {% else %}
      <div class="alert alert-danger">
        ‚ùå Your Codeforces handle "{{ request.user.profile.codeforces_handle }}" is invalid.
      </div>
    {% endif %}
  {% else %}
    <div class="alert alert-warning">
      ‚ö†Ô∏è You have not added a Codeforces handle in your profile.
      <a href="{% url 'profile' %}">Click here to update</a>.
    </div>
  {% endif %}
</div>



  <!-- üîô Back -->
  <a href="{% url 'problem_list' %}" class="btn btn-secondary mt-3">‚Üê Back to List</a>
</div>
{% endblock %}
